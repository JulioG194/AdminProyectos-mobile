<ion-header>
    <ion-toolbar>
        <div class="box align">
            <ion-buttons slot="start">
                <ion-back-button defaultHref="tabs/tabs/tab3"></ion-back-button>
            </ion-buttons>
            <ion-title>Detalles</ion-title>
        </div>
    </ion-toolbar>
</ion-header>

<ion-content padding>
    <div class="background">
        <ion-card class="container1">
            <ion-item color="dark">
                <h2>{{ projectApp.name }}</h2>
            </ion-item>
            <ion-card-content class="container2">
                <p>Cliente: {{ projectApp.client }}</p>
                <p>Tipo: {{ projectApp.type }}</p>
                <p>Fecha de Inicio: {{projectApp.startDate | date : "dd/MM/y"}}</p>
                <p>Fecha de Fin: {{projectApp.endDate | date : "dd/MM/y"}}</p>
                <p>Descripcion: {{ projectApp.description }}</p>
            </ion-card-content>
        </ion-card>

        <ion-list-header color="light" class="align1">
            <h5>Actividades</h5>
            <ion-button color="primary" icon-left (click)="openActivity()">
                <ion-icon style="color: white;" slot="icon-only" name="add-circle-outline"></ion-icon>
            </ion-button>
        </ion-list-header>
        <ion-list *ngFor="let item of activitiesProject; let i = index;" class="accordion-list" lines="none" detail="false" no-padding>
            <ion-card>
                <ion-card-content>
                    <ion-item-sliding>
                        <ion-item tappable (click)="toggleSection(i)" [ngClass]="{'section-active': item.active, 'section': !item.active}">
                            <ion-icon slot="end" name="arrow-forward" *ngIf="!item.active"></ion-icon>
                            <ion-icon slot="end" name="arrow-down" *ngIf="item.active"></ion-icon>
                            <ion-label color="dark" class="container3">
                                <h2 style="white-space: pre-wrap;">{{item.name}}</h2>
                                <p style="color: darkcyan">Fecha de Inicio: {{item.startDate | date : "dd/MM/y"}}</p>
                                <p style="color: darkcyan;">Fecha de Fin: {{item.endDate | date : "dd/MM/y"}}</p>
                                <p style="color: darkcyan;">%Avance: {{item.progress}}</p>
                            </ion-label>
                        </ion-item>

                        <ion-item-options side="end">
                            <ion-button color="primary" icon-left (click)="editActivity(item)">
                                <ion-icon slot="icon-only" name="create"></ion-icon>
                            </ion-button>
                            <ion-button color="danger" icon-left>
                                <ion-icon slot="icon-only" name="trash"></ion-icon>
                            </ion-button>
                        </ion-item-options>
                    </ion-item-sliding>

                    <div *ngIf="item.tasks?.length == 0 && item.active">
                        <ion-list-header color="light" class="align2">
                            <h6 style="color:#3880ff">Tareas</h6>
                            <ion-button color="primary" icon-left (click)="openTask(item)">
                                <ion-icon slot="icon-only" name="add-circle-outline"></ion-icon>
                            </ion-button>
                        </ion-list-header>
                        <h2>Aun no tiene tareas</h2>
                    </div>
                    <div *ngIf="item.tasks?.length > 0 && item.active">
                        <ion-list-header color="light" class="align2">
                            <h6 style="color: #3880ff">Tareas</h6>
                            <ion-button color="primary" icon-left (click)="openTask(item)">
                                <ion-icon slot="icon-only" name="add-circle-outline"></ion-icon>
                            </ion-button>
                        </ion-list-header>

                        <ion-list class="child-list" *ngFor="let child of item.tasks; let j = index;" lines="none">
                            <ion-item-divider color="dark">
                                <ion-item-sliding color="dark">
                                    <ion-item color="dark" tappable [ngClass]="{'child-active': child.active, 'child': !child.active}">
                                        <div class="align3">
                                            <h4 style="color: goldenrod;">{{child.name}}</h4>
                                            <div class="align">
                                                <ion-avatar item-left="item-left">
                                                    <img style="width:45px;height:45px;" [src]="child.delegate.photoURL">
                                                </ion-avatar>
                                                <ion-label class="container2">
                                                    <p>Fecha de Inicio: {{child.startDate | date : "dd/MM/y"}}</p>
                                                    <p>Fecha de Fin: {{child.endDate | date : "dd/MM/y"}}</p>
                                                    <p>%Avance: {{child.progress}}</p>
                                                </ion-label>
                                            </div>
                                        </div>

                                    </ion-item>
                                    <ion-item-options side="start">
                                        <ion-button color="warning" icon-left (click)="openEvidence(child)">
                                            <ion-icon slot="icon-only" name="folder-open-outline"></ion-icon>
                                        </ion-button>

                                    </ion-item-options>
                                    <ion-item-options side="end">
                                        <ion-button color="primary" icon-left (click)="editTask(item, child)">
                                            <ion-icon slot="icon-only" name="create"></ion-icon>
                                        </ion-button>
                                        <ion-button color="danger" icon-left>
                                            <ion-icon slot="icon-only" name="trash"></ion-icon>
                                        </ion-button>
                                    </ion-item-options>
                                </ion-item-sliding>
                            </ion-item-divider>
                        </ion-list>
                    </div>


                </ion-card-content>
            </ion-card>
        </ion-list>

    </div>
</ion-content>